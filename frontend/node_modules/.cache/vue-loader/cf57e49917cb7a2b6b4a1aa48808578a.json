{"remainingRequest":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/patricia/hackaboss/PROYECTO/frontend/frontend/src/views/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/src/views/Profile.vue","mtime":1596744317817},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBTd2FsIGZyb20gInN3ZWV0YWxlcnQyIjsKaW1wb3J0IHsKICBnZXRBdXRoVG9rZW4sCiAgZ2V0SWRUb2tlbiwKICBhbGVydEZ1bmN0aW9uLAogIGdldFJvbGVUb2tlbiwKfSBmcm9tICIuLi91dGlscy9oZWxwZXJzIjsKCmltcG9ydCB1c2VycHJvZmlsZSBmcm9tICJAL2NvbXBvbmVudHMvVXNlclByb2ZpbGUudnVlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJQcm9maWxlIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy92YXJpYWJsZXMgZGUgdmlzdGEKICAgICAgcHJvZmlsZToge30sCiAgICAgIHVzZXJMYW5ndWFnZXM6IFtdLAogICAgICAvL3ZhcmlhYmxlcyBkZSBnZXN0aW9uIGRlIGVycm9yZXMKICAgICAgc2hvd0Vycm9yOiBmYWxzZSwKICAgICAgZXJyb3JNZXNzYWdlOiAiIiwKICAgICAgdXNlclJvbGU6ICIiLAogICAgICAvL1RPS0VOCiAgICAgIHRva2VuOiBnZXRBdXRoVG9rZW4oKSwKICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICB1c2VycHJvZmlsZSwKICB9LAoKICBtZXRob2RzOiB7CiAgICBhc3luYyB1cGRhdGVVc2VyRGF0YSh1c2VyRGF0YSkgewogICAgICBjb25zb2xlLmxvZygidXBkYXRlVXNlckRhdGEiKTsKICAgICAgLy9EQVRPUyBERUwgVVNVQVJJTwogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLAogICAgICAgIGxhc3RfbmFtZTogdXNlckRhdGEubGFzdG5hbWUsCiAgICAgICAgdXNlcm5hbWU6IHVzZXJEYXRhLnVzZXJuYW1lLAogICAgICAgIGVtYWlsOiB1c2VyRGF0YS5lbWFpbCwKICAgICAgICBwcm9maWxlX2JpbzogdXNlckRhdGEucHJvZmlsZSwKICAgICAgfTsKICAgICAgLy9DQUJFQ0VSQSBERSBBVVRPUklaQUNJT04KICAgICAgbGV0IGNvbmZpZyA9IHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiB0aGlzLnRva2VuLAogICAgICAgIH0sCiAgICAgIH07CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucHV0KAogICAgICAgICAgImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC91c2Vycy9lZGl0LXByb2ZpbGUvIiArIHVzZXJEYXRhLmlkLAogICAgICAgICAgZGF0YSwKICAgICAgICAgIGNvbmZpZwogICAgICAgICk7CiAgICAgICAgLy9BTEVSVCBERSBFRElUQVIKICAgICAgICBhd2FpdCBhbGVydEZ1bmN0aW9uKAogICAgICAgICAgInN1Y2Nlc3MiLAogICAgICAgICAgIkFjdHVhbGl6YWRvIiwKICAgICAgICAgIGBIYXMgZWRpdGFkbyBsb3MgZGF0b3MgZGUgJHtkYXRhLnVzZXJuYW1lfSBleGl0b3NhbWVudGVgCiAgICAgICAgKTsKICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICB0aGlzLnNob3dFcnJvciA9IHRydWU7CiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBlcnJvci5yZXNwb25zZS5kYXRhLm1lc3NhZ2U7CiAgICAgIH0KICAgIH0sCiAgICAvL1RSQUlHTyBMQSBJTkZPIERFTCBQRVJGSUwgREUgVVNVQVJJTyBERSBMQSBCQkRECiAgICBhc3luYyBnZXRVc2VyUHJvZmlsZSgpIHsKICAgICAgY29uc29sZS5sb2coImdldFVzZXJwcm9maWxlIik7CiAgICAgIC8vQ0FCRUNFUkEgREUgQVVUT1JJWkFDSU9OCiAgICAgIGxldCBjb25maWcgPSB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogdGhpcy50b2tlbiwKICAgICAgICB9LAogICAgICB9OwoKICAgICAgbGV0IHVzZXJJZCA9IGdldElkVG9rZW4odGhpcy50b2tlbik7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoCiAgICAgICAgICAiaHR0cDovL2xvY2FsaG9zdDozMDAwL3VzZXJzL3Byb2ZpbGUvIiArIHVzZXJJZCwKICAgICAgICAgIGNvbmZpZwogICAgICAgICk7CiAgICAgICAgdGhpcy5wcm9maWxlID0gcmVzcG9uc2UuZGF0YS5kYXRhOwoKICAgICAgICB0aGlzLnByb2ZpbGUuYXZhdGFyID0gcHJvY2Vzcy5lbnYuVlVFX0FQUF9TVEFUSUMgKyB0aGlzLnByb2ZpbGUuYXZhdGFyOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMuc2hvd0Vycm9yID0gdHJ1ZTsKICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGVycm9yLnJlc3BvbnNlLmRhdGEubWVzc2FnZTsKICAgICAgfQogICAgfSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldFVzZXJQcm9maWxlKCk7CiAgfSwKfTsK"},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <p v-show=\"showError\">{{ errorMessage }}</p>\n    <userprofile v-on:iduserupdate=\"updateUserData\" :userdata=\"profile\" />\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport {\n  getAuthToken,\n  getIdToken,\n  alertFunction,\n  getRoleToken,\n} from \"../utils/helpers\";\n\nimport userprofile from \"@/components/UserProfile.vue\";\nexport default {\n  name: \"Profile\",\n  data() {\n    return {\n      //variables de vista\n      profile: {},\n      userLanguages: [],\n      //variables de gestion de errores\n      showError: false,\n      errorMessage: \"\",\n      userRole: \"\",\n      //TOKEN\n      token: getAuthToken(),\n    };\n  },\n  components: {\n    userprofile,\n  },\n\n  methods: {\n    async updateUserData(userData) {\n      console.log(\"updateUserData\");\n      //DATOS DEL USUARIO\n      let data = {\n        name: userData.name,\n        last_name: userData.lastname,\n        username: userData.username,\n        email: userData.email,\n        profile_bio: userData.profile,\n      };\n      //CABECERA DE AUTORIZACION\n      let config = {\n        headers: {\n          Authorization: this.token,\n        },\n      };\n\n      try {\n        const response = await axios.put(\n          \"http://localhost:3000/users/edit-profile/\" + userData.id,\n          data,\n          config\n        );\n        //ALERT DE EDITAR\n        await alertFunction(\n          \"success\",\n          \"Actualizado\",\n          `Has editado los datos de ${data.username} exitosamente`\n        );\n        location.reload();\n      } catch (error) {\n        this.showError = true;\n        this.errorMessage = error.response.data.message;\n      }\n    },\n    //TRAIGO LA INFO DEL PERFIL DE USUARIO DE LA BBDD\n    async getUserProfile() {\n      console.log(\"getUserprofile\");\n      //CABECERA DE AUTORIZACION\n      let config = {\n        headers: {\n          Authorization: this.token,\n        },\n      };\n\n      let userId = getIdToken(this.token);\n      try {\n        const response = await axios.get(\n          \"http://localhost:3000/users/profile/\" + userId,\n          config\n        );\n        this.profile = response.data.data;\n\n        this.profile.avatar = process.env.VUE_APP_STATIC + this.profile.avatar;\n      } catch (error) {\n        this.showError = true;\n        this.errorMessage = error.response.data.message;\n      }\n    },\n  },\n  created() {\n    this.getUserProfile();\n  },\n};\n</script>\n\n<style scoped></style>\n"]}]}