{"remainingRequest":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/patricia/hackaboss/PROYECTO/frontend/frontend/src/views/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/src/views/Profile.vue","mtime":1599157819000},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/patricia/hackaboss/PROYECTO/frontend/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vU1RPUkFHRSBERSBMT1MgREFUT1MgREUgVVNVQVJJTwppbXBvcnQgdXNlckRhdGEgZnJvbSAiQC9kYXRhU3RvcmFnZS91c2VyRGF0YSI7CmltcG9ydCBhcGkgZnJvbSAiQC9hcGkvYXBpIjsKCmltcG9ydCB7IGFsZXJ0RnVuY3Rpb24sIEVORFBPSU5UIH0gZnJvbSAiLi4vdXRpbHMvaGVscGVycyI7CgppbXBvcnQgdXNlcnByb2ZpbGUgZnJvbSAiQC9jb21wb25lbnRzL1VzZXJQcm9maWxlLnZ1ZSI7CmltcG9ydCBjaGFuZ2VwYXNzd29yZCBmcm9tICJAL2NvbXBvbmVudHMvQ2hhbmdlUGFzc3dvcmQudnVlIjsKCmltcG9ydCB7IGNsb25lRGVlcCB9IGZyb20gImxvZGFzaCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlByb2ZpbGUiLAogIGNvbXBvbmVudHM6IHsKICAgIHVzZXJwcm9maWxlLAogICAgY2hhbmdlcGFzc3dvcmQsCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vdmFyaWFibGVzIGRlIHZpc3RhCiAgICAgIHVzZXJMYW5ndWFnZXM6IFtdLAoKICAgICAgYWN0dWFsUGFzc3dvcmQ6ICIiLAogICAgICAvL3ZhcmlhYmxlcyBkZSBnZXN0aW9uIGRlIGVycm9yZXMKICAgICAgc2hvd0Vycm9yOiBmYWxzZSwKICAgICAgZXJyb3JNZXNzYWdlOiAiIiwKCiAgICAgIC8vREFUQSBERSBVU1VBUklPCiAgICAgIHNoYXJlZFN0b3JlOiB1c2VyRGF0YS5zdGF0ZSwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdG9rZW4oKSB7CiAgICAgIHJldHVybiB0aGlzLnNoYXJlZFN0b3JlLnRva2VuOwogICAgfSwKICAgIHVzZXJJZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuc2hhcmVkU3RvcmUuaWQ7CiAgICB9LAogICAgY3VycmVudFVzZXIoKSB7CiAgICAgIHJldHVybiBjbG9uZURlZXAodGhpcy5zaGFyZWRTdG9yZSk7CiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKICAgIGRlbGV0ZUVycm9yKCkgewogICAgICB0aGlzLnNob3dFcnJvciA9IGZhbHNlOwogICAgfSwKICAgIGFzeW5jIHVwZGF0ZVVzZXJEYXRhKHVzZXJEYXRhKSB7CiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAvL0RBVE9TIERFTCBVU1VBUklPIFFVRSBSRUNJQk8gREVTREUgRUwgQ09NUE9ORU5URQogICAgICBmb3JtRGF0YS5hcHBlbmQoIm5hbWUiLCB1c2VyRGF0YS5uYW1lKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCJsYXN0X25hbWUiLCB1c2VyRGF0YS5sYXN0bmFtZSk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgidXNlcm5hbWUiLCB1c2VyRGF0YS51c2VybmFtZSk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgiZW1haWwiLCB1c2VyRGF0YS5lbWFpbCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgicHJvZmlsZV9iaW8iLCB1c2VyRGF0YS5wcm9maWxlKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCJhdmF0YXIiLCB1c2VyRGF0YS5hdmF0YXIpOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS51cGRhdGVVc2VyUHJvZmlsZSh0aGlzLnVzZXJJZCwgZm9ybURhdGEpOwoKICAgICAgICBjb25zdCB1cGRhdGVkVXNlciA9IGF3YWl0IGFwaS5nZXRVc2VyUHJvZmlsZSh0aGlzLnVzZXJJZCk7CgogICAgICAgIHRoaXMuc2hhcmVkU3RvcmUudXNlcm5hbWUgPSB1cGRhdGVkVXNlci51c2VybmFtZTsKICAgICAgICB0aGlzLnNoYXJlZFN0b3JlLmF2YXRhciA9CiAgICAgICAgICBwcm9jZXNzLmVudi5WVUVfQVBQX1NUQVRJQyArIHVwZGF0ZWRVc2VyLmF2YXRhcjsKICAgICAgICB0aGlzLnNoYXJlZFN0b3JlLmVtYWlsID0gdXBkYXRlZFVzZXIuZW1haWw7CiAgICAgICAgdGhpcy5zaGFyZWRTdG9yZS5uYW1lID0gdXBkYXRlZFVzZXIubmFtZTsKICAgICAgICB0aGlzLnNoYXJlZFN0b3JlLmxhc3RuYW1lID0gdXBkYXRlZFVzZXIubGFzdE5hbWU7CiAgICAgICAgdGhpcy5zaGFyZWRTdG9yZS5wcm9maWxlID0gdXBkYXRlZFVzZXIucHJvZmlsZTsKCiAgICAgICAgLy90cmFlciBlbCBwZXJmaWwgZGUgdXN1cmlvIGRlc2RlIGxhIGJiZGQKCiAgICAgICAgYXdhaXQgYWxlcnRGdW5jdGlvbigKICAgICAgICAgICJzdWNjZXNzIiwKICAgICAgICAgICJBY3R1YWxpemFkbyIsCiAgICAgICAgICBgSGFzIGVkaXRhZG8gbG9zIGRhdG9zIGRlICR7dXNlckRhdGEudXNlcm5hbWV9IGV4aXRvc2FtZW50ZWAKICAgICAgICApOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIHRoaXMuc2hvd0Vycm9yID0gdHJ1ZTsKICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGVycm9yOwogICAgICB9CiAgICB9LAoKICAgIC8vQ0FNQklPIERFIENPTlRSQVNFw5FBIEVOIExBIEJCREQKICAgIGFzeW5jIHBvc3ROZXdQYXNzd29yZChkYXRhKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkudXBkYXRlVXNlcnBhc3ModGhpcy51c2VySWQsIGRhdGEpOwoKICAgICAgICBhbGVydEZ1bmN0aW9uKAogICAgICAgICAgInN1Y2Nlc3MiLAogICAgICAgICAgIk5VRVZBIENPTlRSQVNFw5FBIiwKICAgICAgICAgICJIYXMgYWN0dWFsaXphZG8gdHUgY29udGFzZcOxYSBjb24gw6l4aXRvLCBoYXogTG9naW4gZGUgbnVldm8iCiAgICAgICAgKTsKICAgICAgICB0aGlzLnNoYXJlZFN0b3JlLmlkID0gbnVsbDsKICAgICAgICB0aGlzLnNoYXJlZFN0b3JlLnJvbGUgPSBudWxsOwogICAgICAgIHRoaXMuc2hhcmVkU3RvcmUudG9rZW4gPSBudWxsOwogICAgICAgIHRoaXMuc2hhcmVkU3RvcmUudXNlcm5hbWUgPSBudWxsOwogICAgICAgIHRoaXMuc2hhcmVkU3RvcmUuYXZhdGFyID0gbnVsbDsKICAgICAgICB0aGlzLnNoYXJlZFN0b3JlLmVtYWlsID0gbnVsbDsKICAgICAgICB0aGlzLnNoYXJlZFN0b3JlLm5hbWUgPSBudWxsOwogICAgICAgIHRoaXMuc2hhcmVkU3RvcmUubGFzdG5hbWUgPSBudWxsOwogICAgICAgIHRoaXMuc2hhcmVkU3RvcmUucHJvZmlsZSA9IG51bGw7CiAgICAgICAgdGhpcy5zaGFyZWRTdG9yZS5pc0xvZ2dlZCA9IGZhbHNlOwogICAgICAgIGFwaS5sb2dvdXQoKTsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2xvZ2luIik7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy5zaG93RXJyb3IgPSB0cnVlOwogICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gZXJyb3I7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAcA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"container\">\n    <!--DATOS DE USUARIO-->\n\n    <userprofile :currentUser=\"currentUser\" @iduserupdate=\"updateUserData\" :cancel=\"deleteError\" />\n    <p v-show=\"showError\">{{ errorMessage }}</p>\n    <!--CAMBIO DE CONTRASEÑA-->\n    <div>\n      <changepassword :actualPassword=\"actualPassword\" v-on:changePassword=\"postNewPassword\" />\n    </div>\n  </div>\n</template>\n\n<script>\n//STORAGE DE LOS DATOS DE USUARIO\nimport userData from \"@/dataStorage/userData\";\nimport api from \"@/api/api\";\n\nimport { alertFunction, ENDPOINT } from \"../utils/helpers\";\n\nimport userprofile from \"@/components/UserProfile.vue\";\nimport changepassword from \"@/components/ChangePassword.vue\";\n\nimport { cloneDeep } from \"lodash\";\n\nexport default {\n  name: \"Profile\",\n  components: {\n    userprofile,\n    changepassword,\n  },\n\n  data() {\n    return {\n      //variables de vista\n      userLanguages: [],\n\n      actualPassword: \"\",\n      //variables de gestion de errores\n      showError: false,\n      errorMessage: \"\",\n\n      //DATA DE USUARIO\n      sharedStore: userData.state,\n    };\n  },\n  computed: {\n    token() {\n      return this.sharedStore.token;\n    },\n    userId() {\n      return this.sharedStore.id;\n    },\n    currentUser() {\n      return cloneDeep(this.sharedStore);\n    },\n  },\n\n  methods: {\n    deleteError() {\n      this.showError = false;\n    },\n    async updateUserData(userData) {\n      let formData = new FormData();\n      //DATOS DEL USUARIO QUE RECIBO DESDE EL COMPONENTE\n      formData.append(\"name\", userData.name);\n      formData.append(\"last_name\", userData.lastname);\n      formData.append(\"username\", userData.username);\n      formData.append(\"email\", userData.email);\n      formData.append(\"profile_bio\", userData.profile);\n      formData.append(\"avatar\", userData.avatar);\n\n      try {\n        const response = await api.updateUserProfile(this.userId, formData);\n\n        const updatedUser = await api.getUserProfile(this.userId);\n\n        this.sharedStore.username = updatedUser.username;\n        this.sharedStore.avatar =\n          process.env.VUE_APP_STATIC + updatedUser.avatar;\n        this.sharedStore.email = updatedUser.email;\n        this.sharedStore.name = updatedUser.name;\n        this.sharedStore.lastname = updatedUser.lastName;\n        this.sharedStore.profile = updatedUser.profile;\n\n        //traer el perfil de usurio desde la bbdd\n\n        await alertFunction(\n          \"success\",\n          \"Actualizado\",\n          `Has editado los datos de ${userData.username} exitosamente`\n        );\n      } catch (error) {\n        this.showError = true;\n        this.errorMessage = error;\n      }\n    },\n\n    //CAMBIO DE CONTRASEÑA EN LA BBDD\n    async postNewPassword(data) {\n      try {\n        const response = await api.updateUserpass(this.userId, data);\n\n        alertFunction(\n          \"success\",\n          \"NUEVA CONTRASEÑA\",\n          \"Has actualizado tu contaseña con éxito, haz Login de nuevo\"\n        );\n        this.sharedStore.id = null;\n        this.sharedStore.role = null;\n        this.sharedStore.token = null;\n        this.sharedStore.username = null;\n        this.sharedStore.avatar = null;\n        this.sharedStore.email = null;\n        this.sharedStore.name = null;\n        this.sharedStore.lastname = null;\n        this.sharedStore.profile = null;\n        this.sharedStore.isLogged = false;\n        api.logout();\n        this.$router.push(\"/login\");\n      } catch (error) {\n        this.showError = true;\n        this.errorMessage = error;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped></style>\n"]}]}